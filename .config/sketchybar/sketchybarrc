#!/usr/bin/env sh
# TODO: https://github.com/FelixKratz/SketchyBar/discussions/12
# cpu mini, network mini, spotify controls look cool

echo "sketchybar: loading configuration..."
# BAR SETUP
sketchybar -m --bar height=18       \
                    position=top    \
                    padding_left=5  \
                    padding_right=5 \
                    blur_radius=5   \
                    topmost=off     \
                    display=all

sketchybar -m --add event window_focus
sketchybar -m --add event title_change

# GLOBAL DEFAULTS
sketchybar -m --default cache_scripts=on \
                        drawing=on       \
                        icon.font="Tamzen Nerd Font:Medium:14.0" \
                        label.font="Tamzen Nerd Font:Medium:14.0" \

# SPACE DEFAULTS
sketchybar -m --default label.padding_left=6 \
                        label.padding_right=0 \
                        icon.padding_left=12 \
                        icon.padding_right=0 \
                        icon.highlight_color=0xfffb4934 \

# SPACES
sketchybar -m --add space one left \
              --set one associated_display=1 \
                        associated_space=1 \
                        icon.padding_left=3 \
                        icon=I \
                        click_script="yabai -m space --focus 1" \
                        icon_padding_left=0

sketchybar -m --add space two left \
              --set two associated_display=1 \
                        associated_space=2 \
                        icon=II \
                        click_script="yabai -m space --focus 2" \

sketchybar -m --add space three left \
              --set three associated_display=1 \
                          associated_space=3 \
                          icon=III \
                          click_script="yabai -m space --focus 3" \

sketchybar -m --add space four left \
              --set four associated_display=1 \
                         associated_space=4 \
                         icon=IV \
                         click_script="yabai -m space --focus 4" \

sketchybar -m --add space five left \
              --set five associated_display=2 \
                         associated_space=5 \
                         icon=V \
                         click_script="yabai -m space --focus 5" \

sketchybar -m --add space six left \
              --set six associated_display=2 \
                        associated_space=6 \
                        icon=VI \
                        click_script="yabai -m space --focus 6" \

################## LEFT ITEMS ##################

# Window Title
sketchybar -m --add item title left \
              --set title label.padding_left=3 \
                          icon.padding_left=0 \
                          script="~/.config/sketchybar/plugins/title.sh" \
              --subscribe title window_focus \
                                front_app_switched \
                                space_change \
                                title_change \

################# RIGHT ITEMS ####################
sketchybar -m --add item clock right \
              --set clock update_freq=1 \
                          script="~/.config/sketchybar/plugins/clock.sh" \
                          label.padding_left=2 \
                          label.padding_right=0 \
                          icon.padding_left=3 \
                          icon.padding_right=0 \
                          icon=

# Battery
sketchybar -m --add item battery right \
              --set battery update_freq=10 \
                            script="~/.config/sketchybar/plugins/power.sh" \
                            icon= \
                            label.padding_left=2 \
                            label.padding_right=4 \
                            icon.padding_left=0 \
                            icon.padding_right=3

# Cpu graph
sketchybar -m --add graph cpu_user right 150 \
              --set cpu_user script="~/.config/sketchybar/plugins/cpu_graph.sh" \
                             graph.color=0xffffffff \
                             update_freq=2 \
                             width=0 \
                             associated_space=1 \
                             label.padding_left=8 \
                             icon.padding_right=4 \
                             icon.padding_left=8 \
                             icon= \
                             lazy=on \
              --add graph cpu_sys right 150 \
              --set cpu_sys graph.color=0xff48aa2a \
                            label.padding_left=8 \
                            icon.padding_right=4 \
                            icon.padding_left=8 \
                            associated_space=1 \
                            icon= \

# Network graph
# sketchybar -m --add graph network_down right 150 \
#               --set network_down script="~/.config/sketchybar/plugins/network_graph.sh" \
#                              graph.color=0xffffffff \
#                              update_freq=2 \
#                              width=0 \
#                              associated_space=2 \
#                              associated_space=5 \
#                              label.padding_left=8 \
#                              icon.padding_right=4 \
#                              icon.padding_left=8 \
#                              icon=⮁ \
#                              lazy=on \
#               --add graph network_up right 150 \
#               --set network_up graph.color=0xff48aa2a \
#                                label.padding_left=8 \
#                                icon.padding_right=4 \
#                                icon.padding_left=8 \
#                                associated_space=2 \
#                                # associated_space=4 \
#                                icon=⮁ \

# Top proc
# sketchybar -m --add item topproc right \
#               --set topproc label.padding_right=8 \
#                             update_freq=15 \
#                             script="~/.config/sketchybar/plugins/topproc.sh"

###################### CENTER ITEMS ###################
# Spotify
sketchybar -m --add event spotify_change "com.spotify.client.PlaybackStateChanged" \
              --add item spotifyIndicator center \
              --set spotifyIndicator script="~/.config/sketchybar/plugins/spotifyIndicator.sh" \
              --set spotifyIndicator click_script="osascript -e 'tell application \"Spotify\" to pause'" \
              --subscribe spotifyIndicator spotify_change

sketchybar -m --update

echo "sketchybar: configuration loaded"
echo "sketchybar: loading colors..."
source ~/.config/sketchybar/sketchybarcolors
